# 処理フロー

## 0. 準備フェーズ

1. ユーザーが仕様書の作成を Claude desktop で行う
   1. 主にブランジング結果の理解が現時点(2025/04/08)で一番優秀だったため
2. 開発プロジェクトの初期作成はユーザーで行う
   1. AI が実施するほど複雑な処理ではない
   2. ユーザーが実施した方が言語やライブラリなどのバージョンアップに対応しやすい
   3. AI による不備が起きた場合の責任をユーザーが払いきれない将来の可能性がある
3. ユーザーが初期イシューを作成する

## 1. タスク受付フェーズ

1. ユーザーが AI-P（進捗管理エージェント）にイシューの URL を伝える
2. AI-P がイシューの URL より要求・仕様を把握
3. AI-P はタスクの基本情報を記録し、処理プロセスを初期化する

## 2. 分析・計画フェーズ

1. AI-P が AI-A（分析・技術選定エージェント）にタスクの分析を依頼する
2. AI-A がタスク指示内容を詳細に分析する
   - 機能要件の抽出
   - 非機能要件の抽出
   - 制約条件の特定
3. AI-A が最適な技術スタックを選定する
   - 言語・フレームワークの選定
   - ライブラリの選定
   - アーキテクチャパターンの決定
4. AI-A が分析・選定結果を AI-P に返却する

## 3. イシュー作成フェーズ

1. AI-P が分析結果を受け取る
2. AI-P が**親 GitHub イシュー**を作成する
   - タイトルと説明の設定
   - 機能要件のリスト化
   - 技術スタック情報の記載
   - ラベルの設定（初期状態: 「準備中」）

## 4. 環境準備フェーズ

1. AI-P が AI-B（ディレクトリ作成エージェント）にディレクトリ作成を依頼する
2. AI-B が親イシュー内容を読み取る
3. AI-B が適切なプロジェクト構造を設計・作成する
4. AI-B が親 GitHub イシューに完了通知をコメントする
   - 作成したディレクトリ構造の詳細
   - イシューラベルを「環境準備完了」に更新

## 5. 実装フェーズ（並列処理）

1. AI-P が親 GitHub イシューを監視し、「環境準備完了」ラベルを検知する
2. AI-P が AI-T（テスト実装）と AI-D（開発実装）を同時に起動する

### 5-A. テスト実装（AI-T）

1. AI-T が親イシュー内容とプロジェクト構造を確認する
2. AI-T がテストコードを実装する
3. AI-T が親 GitHub イシューに完了通知をコメントする
   - イシューへのラベル追加（「テスト実装完了」）

### 5-B. 機能実装（AI-D）

1. AI-D が親イシュー内容とプロジェクト構造を確認する
2. AI-D が機能コードを実装する
3. AI-D が親 GitHub イシューに完了通知をコメントする
   - イシューへのラベル追加（「機能実装完了」）

## 6. 品質保証・レビューフェーズ

1. AI-P が親 GitHub イシューを監視し、「テスト実装完了」と「機能実装完了」の両方のラベルを検知する
2. AI-P が改善要求回数カウンターを 0 に初期化する
3. AI-P が AI-Q（品質チェック兼コードレビュー）を呼び出す
4. AI-Q がテストと実装内容を検証する
   - テストの網羅性確認
   - 実装の品質確認
   - コードレビュー

### 6-A. 改善が必要な場合

1. AI-Q が GitHub イシューに改善要求をコメントする
   - イシューラベルを「改善要求」に更新
2. AI-P が親 GitHub イシューの「改善要求」ラベルを検知する
3. AI-P が改善要求回数カウンターをインクリメントする
4. AI-P が改善要求回数が 3 回未満かチェックする
   - 3 回以上の場合は 6-B の「品質基準を満たした」ルートに強制的に進む
5. AI-P が親イシューに紐づく**子イシュー**を作成する
   - 改善要求内容の詳細を記載
   - 担当エージェント（AI-T または AI-D）を指定
6. 担当エージェント（AI-T または AI-D）が子イシューを確認する
7. 担当エージェントが改善を実施する
8. 担当エージェントが子イシューをクローズし、親イシューにコメントする
9. AI-P が親イシューの更新を検知し、再度 AI-Q を呼び出す（ステップ 6-4 から繰り返し）

### 6-B. 品質基準を満たした場合

1. AI-Q が GitHub イシューに品質承認をコメントする
   - イシューラベルを「品質チェック・レビュー完了」に更新
2. AI-Q が Pull Request を作成する

## 7. 完了フェーズ

1. AI-P が親 GitHub イシューの「品質チェック・レビュー完了」ラベルを検知する
2. AI-P が Pull Request をマージする
3. AI-P が親イシューをクローズし、タスク完了とする
